import{g as e,h as t,p as n}from"./src-BTVLHTZh.js";import{I as r,N as i,O as a,s as o,y as s}from"./chunk-ABZYJK2D-nwu0vvvU.js";import{a as c}from"./chunk-S3R3BYOJ-CAqmdAlk.js";import{t as l}from"./marked.esm-BRKGye63.js";var u=Object.freeze({left:0,top:0,width:16,height:16}),d=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),f=Object.freeze({...u,...d}),p=Object.freeze({...f,body:``,hidden:!1}),m=Object.freeze({width:null,height:null}),h=Object.freeze({...m,...d}),g=(e,t,n,r=``)=>{let i=e.split(`:`);if(e.slice(0,1)===`@`){if(i.length<2||i.length>3)return null;r=i.shift().slice(1)}if(i.length>3||!i.length)return null;if(i.length>1){let e=i.pop(),n=i.pop(),a={provider:i.length>0?i[0]:r,prefix:n,name:e};return t&&!_(a)?null:a}let a=i[0],o=a.split(`-`);if(o.length>1){let e={provider:r,prefix:o.shift(),name:o.join(`-`)};return t&&!_(e)?null:e}if(n&&r===``){let e={provider:r,prefix:``,name:a};return t&&!_(e,n)?null:e}return null},_=(e,t)=>e?!!((t&&e.prefix===``||e.prefix)&&e.name):!1;function v(e,t){let n={};!e.hFlip!=!t.hFlip&&(n.hFlip=!0),!e.vFlip!=!t.vFlip&&(n.vFlip=!0);let r=((e.rotate||0)+(t.rotate||0))%4;return r&&(n.rotate=r),n}function y(e,t){let n=v(e,t);for(let r in p)r in d?r in e&&!(r in n)&&(n[r]=d[r]):r in t?n[r]=t[r]:r in e&&(n[r]=e[r]);return n}function ee(e,t){let n=e.icons,r=e.aliases||Object.create(null),i=Object.create(null);function a(e){if(n[e])return i[e]=[];if(!(e in i)){i[e]=null;let t=r[e]&&r[e].parent,n=t&&a(t);n&&(i[e]=[t].concat(n))}return i[e]}return(t||Object.keys(n).concat(Object.keys(r))).forEach(a),i}function b(e,t,n){let r=e.icons,i=e.aliases||Object.create(null),a={};function o(e){a=y(r[e]||i[e],a)}return o(t),n.forEach(o),y(e,a)}function te(e,t){if(e.icons[t])return b(e,t,[]);let n=ee(e,[t])[t];return n?b(e,t,n):null}var x=/(-?[0-9.]*[0-9]+[0-9.]*)/g,S=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function C(e,t,n){if(t===1)return e;if(n||=100,typeof e==`number`)return Math.ceil(e*t*n)/n;if(typeof e!=`string`)return e;let r=e.split(x);if(r===null||!r.length)return e;let i=[],a=r.shift(),o=S.test(a);for(;;){if(o){let e=parseFloat(a);isNaN(e)?i.push(a):i.push(Math.ceil(e*t*n)/n)}else i.push(a);if(a=r.shift(),a===void 0)return i.join(``);o=!o}}function ne(e,t=`defs`){let n=``,r=e.indexOf(`<`+t);for(;r>=0;){let i=e.indexOf(`>`,r),a=e.indexOf(`</`+t);if(i===-1||a===-1)break;let o=e.indexOf(`>`,a);if(o===-1)break;n+=e.slice(i+1,a).trim(),e=e.slice(0,r).trim()+e.slice(o+1)}return{defs:n,content:e}}function w(e,t){return e?`<defs>`+e+`</defs>`+t:t}function T(e,t,n){let r=ne(e);return w(r.defs,t+r.content+n)}var E=e=>e===`unset`||e===`undefined`||e===`none`;function D(e,t){let n={...f,...e},r={...h,...t},i={left:n.left,top:n.top,width:n.width,height:n.height},a=n.body;[n,r].forEach(e=>{let t=[],n=e.hFlip,r=e.vFlip,o=e.rotate;n?r?o+=2:(t.push(`translate(`+(i.width+i.left).toString()+` `+(0-i.top).toString()+`)`),t.push(`scale(-1 1)`),i.top=i.left=0):r&&(t.push(`translate(`+(0-i.left).toString()+` `+(i.height+i.top).toString()+`)`),t.push(`scale(1 -1)`),i.top=i.left=0);let s;switch(o<0&&(o-=Math.floor(o/4)*4),o%=4,o){case 1:s=i.height/2+i.top,t.unshift(`rotate(90 `+s.toString()+` `+s.toString()+`)`);break;case 2:t.unshift(`rotate(180 `+(i.width/2+i.left).toString()+` `+(i.height/2+i.top).toString()+`)`);break;case 3:s=i.width/2+i.left,t.unshift(`rotate(-90 `+s.toString()+` `+s.toString()+`)`);break}o%2==1&&(i.left!==i.top&&(s=i.left,i.left=i.top,i.top=s),i.width!==i.height&&(s=i.width,i.width=i.height,i.height=s)),t.length&&(a=T(a,`<g transform="`+t.join(` `)+`">`,`</g>`))});let o=r.width,s=r.height,c=i.width,l=i.height,u,d;o===null?(d=s===null?`1em`:s===`auto`?l:s,u=C(d,c/l)):(u=o===`auto`?c:o,d=s===null?C(u,l/c):s===`auto`?l:s);let p={},m=(e,t)=>{E(t)||(p[e]=t.toString())};m(`width`,u),m(`height`,d);let g=[i.left,i.top,c,l];return p.viewBox=g.join(` `),{attributes:p,viewBox:g,body:a}}var O=/\sid="(\S+)"/g,k=new Map;function re(e){e=e.replace(/[0-9]+$/,``)||`a`;let t=k.get(e)||0;return k.set(e,t+1),t?`${e}${t}`:e}function ie(e){let t=[],n;for(;n=O.exec(e);)t.push(n[1]);if(!t.length)return e;let r=`suffix`+(Math.random()*16777216|Date.now()).toString(16);return t.forEach(t=>{let n=re(t),i=t.replace(/[.*+?^${}()|[\]\\]/g,`\\$&`);e=e.replace(RegExp(`([#;"])(`+i+`)([")]|\\.[a-z])`,`g`),`$1`+n+r+`$3`)}),e=e.replace(new RegExp(r,`g`),``),e}function ae(e,t){let n=e.indexOf(`xlink:`)===-1?``:` xmlns:xlink="http://www.w3.org/1999/xlink"`;for(let e in t)n+=` `+e+`="`+t[e]+`"`;return`<svg xmlns="http://www.w3.org/2000/svg"`+n+`>`+e+`</svg>`}function A(e){var t=[...arguments].slice(1),n=Array.from(typeof e==`string`?[e]:e);n[n.length-1]=n[n.length-1].replace(/\r?\n([\t ]*)$/,``);var r=n.reduce(function(e,t){var n=t.match(/\n([\t ]+|(?!\s).)/g);return n?e.concat(n.map(function(e){return e.match(/[\t ]/g)?.length??0})):e},[]);if(r.length){var i=RegExp(`
[	 ]{`+Math.min.apply(Math,r)+`}`,`g`);n=n.map(function(e){return e.replace(i,`
`)})}n[0]=n[0].replace(/^\r?\n/,``);var a=n[0];return t.forEach(function(e,t){var r=a.match(/(?:^|\n)( *)$/),i=r?r[1]:``,o=e;typeof e==`string`&&e.includes(`
`)&&(o=String(e).split(`
`).map(function(e,t){return t===0?e:``+i+e}).join(`
`)),a+=o+n[t+1]}),a}var j={body:`<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/><text transform="translate(21.16 64.67)" style="fill: #fff; font-family: ArialMT, Arial; font-size: 67.75px;"><tspan x="0" y="0">?</tspan></text></g>`,height:80,width:80},M=new Map,N=new Map,P=t(t=>{for(let n of t){if(!n.name)throw Error(`Invalid icon loader. Must have a "name" property with non-empty string value.`);if(e.debug(`Registering icon pack:`,n.name),`loader`in n)N.set(n.name,n.loader);else if(`icons`in n)M.set(n.name,n.icons);else throw e.error(`Invalid icon loader:`,n),Error(`Invalid icon loader. Must have either "icons" or "loader" property.`)}},`registerIconPacks`),F=t(async(t,n)=>{let r=g(t,!0,n!==void 0);if(!r)throw Error(`Invalid icon name: ${t}`);let i=r.prefix||n;if(!i)throw Error(`Icon name must contain a prefix: ${t}`);let a=M.get(i);if(!a){let t=N.get(i);if(!t)throw Error(`Icon set not found: ${r.prefix}`);try{a={...await t(),prefix:i},M.set(i,a)}catch(t){throw e.error(t),Error(`Failed to load icon set: ${r.prefix}`)}}let o=te(a,r.name);if(!o)throw Error(`Icon not found: ${t}`);return o},`getRegisteredIconData`),I=t(async e=>{try{return await F(e),!0}catch{return!1}},`isIconAvailable`),L=t(async(t,n,i)=>{let a;try{a=await F(t,n?.fallbackPrefix)}catch(t){e.error(t),a=j}let o=D(a,n);return r(ae(ie(o.body),{...o.attributes,...i}),s())},`getIconSVG`);function R(e,{markdownAutoWrap:t}){let n=A(e.replace(/<br\/>/g,`
`).replace(/\n{2,}/g,`
`));return t===!1?n.replace(/ /g,`&nbsp;`):n}t(R,`preprocessMarkdown`);function z(e,n={}){let r=R(e,n),i=l.lexer(r),a=[[]],o=0;function s(e,t=`normal`){e.type===`text`?e.text.split(`
`).forEach((e,n)=>{n!==0&&(o++,a.push([])),e.split(` `).forEach(e=>{e=e.replace(/&#39;/g,`'`),e&&a[o].push({content:e,type:t})})}):e.type===`strong`||e.type===`em`?e.tokens.forEach(t=>{s(t,e.type)}):e.type===`html`&&a[o].push({content:e.text,type:`normal`})}return t(s,`processNode`),i.forEach(e=>{e.type===`paragraph`?e.tokens?.forEach(e=>{s(e)}):e.type===`html`?a[o].push({content:e.text,type:`normal`}):a[o].push({content:e.raw,type:`normal`})}),a}t(z,`markdownToLines`);function B(n,{markdownAutoWrap:r}={}){let i=l.lexer(n);function a(t){return t.type===`text`?r===!1?t.text.replace(/\n */g,`<br/>`).replace(/ /g,`&nbsp;`):t.text.replace(/\n */g,`<br/>`):t.type===`strong`?`<strong>${t.tokens?.map(a).join(``)}</strong>`:t.type===`em`?`<em>${t.tokens?.map(a).join(``)}</em>`:t.type===`paragraph`?`<p>${t.tokens?.map(a).join(``)}</p>`:t.type===`space`?``:t.type===`html`?`${t.text}`:t.type===`escape`?t.text:(e.warn(`Unsupported markdown: ${t.type}`),t.raw)}return t(a,`output`),i.map(a).join(``)}t(B,`markdownToHTML`);function V(e){return Intl.Segmenter?[...new Intl.Segmenter().segment(e)].map(e=>e.segment):[...e]}t(V,`splitTextToChars`);function H(e,t){return U(e,[],V(t.content),t.type)}t(H,`splitWordToFitWidth`);function U(e,t,n,r){if(n.length===0)return[{content:t.join(``),type:r},{content:``,type:r}];let[i,...a]=n,o=[...t,i];return e([{content:o.join(``),type:r}])?U(e,o,a,r):(t.length===0&&i&&(t.push(i),n.shift()),[{content:t.join(``),type:r},{content:n.join(``),type:r}])}t(U,`splitWordToFitWidthRecursion`);function W(e,t){if(e.some(({content:e})=>e.includes(`
`)))throw Error(`splitLineToFitWidth does not support newlines in the line`);return G(e,t)}t(W,`splitLineToFitWidth`);function G(e,t,n=[],r=[]){if(e.length===0)return r.length>0&&n.push(r),n.length>0?n:[];let i=``;e[0].content===` `&&(i=` `,e.shift());let a=e.shift()??{content:` `,type:`normal`},o=[...r];if(i!==``&&o.push({content:i,type:`normal`}),o.push(a),t(o))return G(e,t,n,o);if(r.length>0)n.push(r),e.unshift(a);else if(a.content){let[r,i]=H(t,a);n.push([r]),i.content&&e.unshift(i)}return G(e,t,n)}t(G,`splitLineToFitWidthRecursion`);function K(e,t){t&&e.attr(`style`,t)}t(K,`applyStyle`);async function q(e,t,n,c,l=!1,u=s()){let d=e.append(`foreignObject`);d.attr(`width`,`${10*n}px`),d.attr(`height`,`${10*n}px`);let f=d.append(`xhtml:div`),p=a(t.label)?await i(t.label.replace(o.lineBreakRegex,`
`),u):r(t.label,u),m=t.isNode?`nodeLabel`:`edgeLabel`,h=f.append(`span`);h.html(p),K(h,t.labelStyle),h.attr(`class`,`${m} ${c}`),K(f,t.labelStyle),f.style(`display`,`table-cell`),f.style(`white-space`,`nowrap`),f.style(`line-height`,`1.5`),f.style(`max-width`,n+`px`),f.style(`text-align`,`center`),f.attr(`xmlns`,`http://www.w3.org/1999/xhtml`),l&&f.attr(`class`,`labelBkg`);let g=f.node().getBoundingClientRect();return g.width===n&&(f.style(`display`,`table`),f.style(`white-space`,`break-spaces`),f.style(`width`,n+`px`),g=f.node().getBoundingClientRect()),d.node()}t(q,`addHtmlSpan`);function J(e,t,n){return e.append(`tspan`).attr(`class`,`text-outer-tspan`).attr(`x`,0).attr(`y`,t*n-.1+`em`).attr(`dy`,n+`em`)}t(J,`createTspan`);function Y(e,t,n){let r=e.append(`text`),i=J(r,1,t);Q(i,n);let a=i.node().getComputedTextLength();return r.remove(),a}t(Y,`computeWidthOfText`);function X(e,t,n){let r=e.append(`text`),i=J(r,1,t);Q(i,[{content:n,type:`normal`}]);let a=i.node()?.getBoundingClientRect();return a&&r.remove(),a}t(X,`computeDimensionOfText`);function Z(e,n,r,i=!1){let a=1.1,o=n.append(`g`),s=o.insert(`rect`).attr(`class`,`background`).attr(`style`,`stroke: none`),c=o.append(`text`).attr(`y`,`-10.1`),l=0;for(let n of r){let r=t(t=>Y(o,a,t)<=e,`checkWidth`),i=r(n)?[n]:W(n,r);for(let e of i)Q(J(c,l,a),e),l++}if(i){let e=c.node().getBBox();return s.attr(`x`,e.x-2).attr(`y`,e.y-2).attr(`width`,e.width+4).attr(`height`,e.height+4),o.node()}else return c.node()}t(Z,`createFormattedText`);function Q(e,t){e.text(``),t.forEach((t,n)=>{let r=e.append(`tspan`).attr(`font-style`,t.type===`em`?`italic`:`normal`).attr(`class`,`text-inner-tspan`).attr(`font-weight`,t.type===`strong`?`bold`:`normal`);n===0?r.text(t.content):r.text(` `+t.content)})}t(Q,`updateTextContentAndStyles`);async function $(e,t={}){let n=[];e.replace(/(fa[bklrs]?):fa-([\w-]+)/g,(e,i,a)=>(n.push((async()=>{let n=`${i}:${a}`;return await I(n)?await L(n,void 0,{class:`label-icon`}):`<i class='${r(e,t).replace(`:`,` `)}'></i>`})()),e));let i=await Promise.all(n);return e.replace(/(fa[bklrs]?):fa-([\w-]+)/g,()=>i.shift()??``)}t($,`replaceIconSubstring`);var oe=t(async(t,r=``,{style:i=``,isTitle:o=!1,classes:s=``,useHtmlLabels:l=!0,isNode:u=!0,width:d=200,addSvgBackground:f=!1}={},p)=>{if(e.debug(`XYZ createText`,r,i,o,s,l,u,`addSvgBackground: `,f),l){let e=await $(c(B(r,p)),p),n=r.replace(/\\\\/g,`\\`);return await q(t,{isNode:u,label:a(r)?n:e,labelStyle:i.replace(`fill:`,`color:`)},d,s,f,p)}else{let e=Z(d,t,z(r.replace(/<br\s*\/?>/g,`<br/>`).replace(`<br>`,`<br/>`),p),r?f:!1);if(u){/stroke:/.exec(i)&&(i=i.replace(`stroke:`,`lineColor:`));let t=i.replace(/stroke:[^;]+;?/g,``).replace(/stroke-width:[^;]+;?/g,``).replace(/fill:[^;]+;?/g,``).replace(/color:/g,`fill:`);n(e).attr(`style`,t)}else{let t=i.replace(/stroke:[^;]+;?/g,``).replace(/stroke-width:[^;]+;?/g,``).replace(/fill:[^;]+;?/g,``).replace(/background:/g,`fill:`);n(e).select(`rect`).attr(`style`,t.replace(/background:/g,`fill:`));let r=i.replace(/stroke:[^;]+;?/g,``).replace(/stroke-width:[^;]+;?/g,``).replace(/fill:[^;]+;?/g,``).replace(/color:/g,`fill:`);n(e).select(`text`).attr(`style`,r)}return e}},`createText`);export{$ as a,P as i,oe as n,j as o,L as r,A as s,X as t};