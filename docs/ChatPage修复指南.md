# ChatPage.vue ä¿®å¤æŒ‡å—

## ğŸ“Š æ€»ä½“è¿›åº¦

- âœ… **é˜¶æ®µ 1**: åŸºç¡€è®¾æ–½å’Œå·¥å…·å‡½æ•° (2/2 å®Œæˆ)
- â³ **é˜¶æ®µ 2**: æ¶ˆæ¯æ¸²æŸ“ç»„ä»¶å®Œå–„ (0/5)
- â³ **é˜¶æ®µ 3**: å›¾ç‰‡åŠŸèƒ½ (0/2)
- â³ **é˜¶æ®µ 4**: å­ä»£ç†åŠŸèƒ½ (0/2)
- â³ **é˜¶æ®µ 5**: æµäº‹ä»¶å¤„ç†å¢å¼º (0/1)
- â³ **é˜¶æ®µ 6**: æ ·å¼å®Œå–„ (0/2)
- â³ **é˜¶æ®µ 7**: è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½ (0/1)
- â³ **é˜¶æ®µ 8**: ç±»å‹å®šä¹‰å’Œä¼˜åŒ– (0/2)

**æ€»è¿›åº¦**: 2/17 ä»»åŠ¡å®Œæˆ (11.8%)

---

## æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›äº†ä¿®å¤ `packages/web/src/modules/chat/pages/ChatPage.vue` ç»„ä»¶çš„è¯¦ç»†æ­¥éª¤ã€‚å‚è€ƒå®Œæ•´å®ç°ï¼š`packages/backend/public/chat.html`

## ä¿®å¤åŸåˆ™

1. **ä½¿ç”¨ VueUse**ï¼šåˆ©ç”¨ VueUse æä¾›çš„ç»„åˆå¼å‡½æ•°
2. **æ‹†åˆ† Hooks**ï¼šå°†é€»è¾‘æ‹†åˆ†ä¸ºç‹¬ç«‹çš„ composables
3. **æ‹†åˆ†ç»„ä»¶**ï¼šåˆ›å»ºå¯å¤ç”¨çš„å­ç»„ä»¶
4. **ä½¿ç”¨ Emit**ï¼šç»„ä»¶é—´é€šä¿¡ä½¿ç”¨äº‹ä»¶å‘å°„
5. **æ¸è¿›å¼ä¿®å¤**ï¼šæ¯æ¬¡åªä¿®å¤ä¸€ä¸ªåŠŸèƒ½æ¨¡å—

## å½“å‰é—®é¢˜åˆ†æ

### 1. ç¼ºå¤±çš„æ ¸å¿ƒåŠŸèƒ½
- âŒ MessageRenderer ç»„ä»¶ä¸å®Œæ•´ï¼ˆç¼ºå°‘å·¥å…·å¡ç‰‡ã€æƒé™è¯·æ±‚ã€å­ä»£ç†ã€TODOåˆ—è¡¨æ¸²æŸ“ï¼‰
- âœ… ~~ç¼ºå°‘ ScrollButtons ç»„ä»¶~~ (å·²å®Œæˆ)
- âŒ ç¼ºå°‘å›¾ç‰‡æŸ¥çœ‹å™¨ï¼ˆImageViewerï¼‰
- âŒ ç¼ºå°‘å­ä»£ç†è§†å›¾åŠŸèƒ½
- âœ… ~~æ™ºèƒ½æ»šåŠ¨åŠŸèƒ½æœªå®ç°~~ (å·²å®Œæˆ)
- âŒ å›¾ç‰‡é¢„è§ˆåŠŸèƒ½ä¸å®Œæ•´

### 2. æ ·å¼é—®é¢˜
- âŒ ç¼ºå°‘ Gemini é£æ ¼è¾“å…¥å®¹å™¨æ ·å¼
- âŒ ç¼ºå°‘å·¥å…·å¡ç‰‡æ ·å¼
- âŒ ç¼ºå°‘ Diff æ˜¾ç¤ºæ ·å¼
- âŒ ç¼ºå°‘å›¾ç‰‡æŸ¥çœ‹å™¨æ ·å¼

### 3. é€»è¾‘é—®é¢˜
- âŒ handleStreamEvent äº‹ä»¶å¤„ç†ä¸å®Œæ•´
- âŒ ç¼ºå°‘å­ä»£ç†æ¶ˆæ¯åˆ†ç»„é€»è¾‘
- âŒ è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½ä¸å®Œæ•´

---

## ä¿®å¤ä»»åŠ¡åˆ—è¡¨

### é˜¶æ®µ 1ï¼šåŸºç¡€è®¾æ–½å’Œå·¥å…·å‡½æ•° âœ…

#### Task 1.1: åˆ›å»ºæ™ºèƒ½æ»šåŠ¨ Hook âœ…
**æ–‡ä»¶**: `packages/web/src/modules/chat/composables/useSmartScroll.ts`

**çŠ¶æ€**: âœ… å·²å®Œæˆ

**ç›®æ ‡**: å®ç°æ™ºèƒ½æ»šåŠ¨åŠŸèƒ½ï¼Œåªåœ¨ç”¨æˆ·æ¥è¿‘åº•éƒ¨æ—¶è‡ªåŠ¨æ»šåŠ¨

**ä¾èµ–**: VueUse çš„ `useScroll`

**åŠŸèƒ½**:
- âœ… æ£€æµ‹å®¹å™¨æ»šåŠ¨ä½ç½®
- âœ… æ™ºèƒ½åˆ¤æ–­æ˜¯å¦éœ€è¦è‡ªåŠ¨æ»šåŠ¨
- âœ… æä¾›æ»šåŠ¨åˆ°é¡¶éƒ¨/åº•éƒ¨çš„æ–¹æ³•
- âœ… æä¾›è·ç¦»è®¡ç®—å’ŒçŠ¶æ€ç›‘å¬

**å®ç°äº®ç‚¹**:
- ä½¿ç”¨ VueUse çš„ `useScroll` è¿›è¡Œæ»šåŠ¨ç›‘å¬
- æä¾› `smartScrollToBottom`ã€`scrollToBottom`ã€`scrollToTop` ä¸‰ç§æ»šåŠ¨æ–¹æ³•
- å¯¼å‡º `isNearBottom`ã€`distanceFromBottom`ã€`distanceFromTop` å“åº”å¼çŠ¶æ€
- æ”¯æŒè‡ªå®šä¹‰é˜ˆå€¼å’Œå¹³æ»‘æ»šåŠ¨é…ç½®
- å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰å’Œ JSDoc æ³¨é‡Š

**å‚è€ƒ**: `chat.html` ç¬¬ 2000-2050 è¡Œçš„ `smartScrollToBottom` å‡½æ•°

---

#### Task 1.2: åˆ›å»ºæ»šåŠ¨æŒ‰é’®ç»„ä»¶ âœ…
**æ–‡ä»¶**: `packages/web/src/modules/chat/components/ScrollButtons.vue`

**çŠ¶æ€**: âœ… å·²å®Œæˆ

**ç›®æ ‡**: åˆ›å»ºå›åˆ°é¡¶éƒ¨/åº•éƒ¨çš„æµ®åŠ¨æŒ‰é’®

**ä¾èµ–**: 
- VueUse çš„ `useScroll`
- Task 1.1 çš„ useSmartScroll

**åŠŸèƒ½**:
- âœ… ç›‘å¬å®¹å™¨æ»šåŠ¨ä½ç½®
- âœ… æ ¹æ®ä½ç½®æ˜¾ç¤º/éšè—æŒ‰é’®
- âœ… å¹³æ»‘æ»šåŠ¨åˆ°é¡¶éƒ¨/åº•éƒ¨
- âœ… æ”¯æŒé€šè¿‡ ID æˆ– class æŸ¥æ‰¾å®¹å™¨
- âœ… æ”¯æŒç›´æ¥ä¼ å…¥å®¹å™¨å¼•ç”¨

**å®ç°äº®ç‚¹**:
- ä½¿ç”¨ VueUse çš„ `useScroll` è¿›è¡Œæ»šåŠ¨ç›‘å¬
- æ”¯æŒ `containerId` å’Œ `containerRef` ä¸¤ç§æ–¹å¼æŒ‡å®šå®¹å™¨
- å¯é…ç½®çš„é˜ˆå€¼ï¼ˆthresholdï¼‰
- å“åº”å¼æŒ‰é’®æ˜¾ç¤º/éšè—
- å®Œæ•´çš„æ— éšœç¢æ”¯æŒï¼ˆaria-labelï¼‰
- æš—è‰²æ¨¡å¼æ”¯æŒ
- ä¼˜é›…çš„æ‚¬åœå’Œç‚¹å‡»åŠ¨ç”»æ•ˆæœ

**å‚è€ƒ**: `chat.html` ç¬¬ 1517-1584 è¡Œçš„ ScrollButtons ç»„ä»¶

---

### é˜¶æ®µ 2ï¼šæ¶ˆæ¯æ¸²æŸ“ç»„ä»¶å®Œå–„

#### Task 2.1: å®Œå–„ MessageRenderer - ç”¨æˆ·æ¶ˆæ¯
**æ–‡ä»¶**: `packages/web/src/modules/chat/components/MessageRenderer.vue`

**ç›®æ ‡**: å®ç°ç”¨æˆ·æ¶ˆæ¯çš„å®Œæ•´æ¸²æŸ“

**åŠŸèƒ½**:
- ç”¨æˆ·å¤´åƒ
- æ¶ˆæ¯æ°”æ³¡æ ·å¼
- æ—¶é—´æˆ³æ˜¾ç¤º
- Markdown æ¸²æŸ“æ”¯æŒ

**å‚è€ƒ**: `chat.html` ç¬¬ 3328-3337 è¡Œ

---

#### Task 2.2: å®Œå–„ MessageRenderer - å·¥å…·è°ƒç”¨å¡ç‰‡
**æ–‡ä»¶**: `packages/web/src/modules/chat/components/MessageRenderer.vue`

**ç›®æ ‡**: å®ç°å·¥å…·è°ƒç”¨ï¼ˆBashã€Write ç­‰ï¼‰çš„æ¸²æŸ“

**åŠŸèƒ½**:
- å·¥å…·å¡ç‰‡æŠ˜å /å±•å¼€
- è¾“å…¥å‚æ•°æ˜¾ç¤º
- æ‰§è¡Œç»“æœæ˜¾ç¤º
- é”™è¯¯çŠ¶æ€æ˜¾ç¤º
- Diff é¢„è§ˆï¼ˆWrite å·¥å…·ï¼‰

**å‚è€ƒ**: `chat.html` ç¬¬ 3348-3408 è¡Œ

---

#### Task 2.3: å®Œå–„ MessageRenderer - æƒé™è¯·æ±‚å¡ç‰‡
**æ–‡ä»¶**: `packages/web/src/modules/chat/components/MessageRenderer.vue`

**ç›®æ ‡**: å®ç°æƒé™å®¡æ‰¹ UI

**åŠŸèƒ½**:
- æƒé™è¯·æ±‚ä¿¡æ¯æ˜¾ç¤º
- æ‰¹å‡†/æ‹’ç»æŒ‰é’®
- å·¥å…·è¾“å…¥å‚æ•°é¢„è§ˆ

**Emit äº‹ä»¶**:
- `approve-permission`: æ‰¹å‡†æƒé™
- `deny-permission`: æ‹’ç»æƒé™

**å‚è€ƒ**: `chat.html` ç¬¬ 3410-3437 è¡Œ

---

#### Task 2.4: å®Œå–„ MessageRenderer - å­ä»£ç†å¡ç‰‡
**æ–‡ä»¶**: `packages/web/src/modules/chat/components/MessageRenderer.vue`

**ç›®æ ‡**: å®ç°å­ä»£ç†ï¼ˆAgentï¼‰çš„æ¸²æŸ“

**åŠŸèƒ½**:
- å­ä»£ç†ä¿¡æ¯æ˜¾ç¤º
- æŠ˜å /å±•å¼€åŠŸèƒ½
- æ‰“å¼€å­ä»£ç†å¯¹è¯æŒ‰é’®
- å­ä»£ç†æ¶ˆæ¯æ•°é‡æ˜¾ç¤º

**Emit äº‹ä»¶**:
- `open-subagent`: æ‰“å¼€å­ä»£ç†è§†å›¾

**å‚è€ƒ**: `chat.html` ç¬¬ 3439-3518 è¡Œ

---

#### Task 2.5: å®Œå–„ MessageRenderer - TODO åˆ—è¡¨å¡ç‰‡
**æ–‡ä»¶**: `packages/web/src/modules/chat/components/MessageRenderer.vue`

**ç›®æ ‡**: å®ç° TODO åˆ—è¡¨çš„æ¸²æŸ“

**åŠŸèƒ½**:
- TODO é¡¹çŠ¶æ€æ˜¾ç¤ºï¼ˆå®Œæˆ/è¿›è¡Œä¸­/å¾…å¤„ç†ï¼‰
- çŠ¶æ€å›¾æ ‡å’Œé¢œè‰²
- æ´»åŠ¨æ–‡ä»¶æ˜¾ç¤º

**å‚è€ƒ**: `chat.html` ç¬¬ 3520-3560 è¡Œ

---

### é˜¶æ®µ 3ï¼šå›¾ç‰‡åŠŸèƒ½

#### Task 3.1: åˆ›å»ºå›¾ç‰‡æŸ¥çœ‹å™¨ç»„ä»¶
**æ–‡ä»¶**: `packages/web/src/modules/chat/components/ImageViewer.vue`

**ç›®æ ‡**: å®ç°å…¨å±å›¾ç‰‡æŸ¥çœ‹å™¨

**ä¾èµ–**: VueUse çš„ `useDraggable`

**åŠŸèƒ½**:
- å…¨å±æ˜¾ç¤ºå›¾ç‰‡
- ç¼©æ”¾æ§åˆ¶ï¼ˆæ”¾å¤§/ç¼©å°/é‡ç½®ï¼‰
- æ‹–æ‹½ç§»åŠ¨
- å…³é—­æŒ‰é’®
- ESC é”®å…³é—­

**å‚è€ƒ**: `chat.html` ç¬¬ 1000-1100 è¡Œçš„å›¾ç‰‡æŸ¥çœ‹å™¨æ ·å¼å’Œé€»è¾‘

---

#### Task 3.2: åˆ›å»ºå›¾ç‰‡é¢„è§ˆ Hook
**æ–‡ä»¶**: `packages/web/src/modules/chat/composables/useImagePreview.ts`

**ç›®æ ‡**: ç®¡ç†è¾“å…¥æ¡†ä¸­çš„å›¾ç‰‡é¢„è§ˆ

**åŠŸèƒ½**:
- æ·»åŠ å›¾ç‰‡é¢„è§ˆ
- åˆ é™¤å›¾ç‰‡é¢„è§ˆ
- æ¸²æŸ“é¢„è§ˆåˆ—è¡¨
- æ‰“å¼€å›¾ç‰‡æŸ¥çœ‹å™¨

**å‚è€ƒ**: `chat.html` ä¸­çš„å›¾ç‰‡é¢„è§ˆé€»è¾‘

---

### é˜¶æ®µ 4ï¼šå­ä»£ç†åŠŸèƒ½

#### Task 4.1: åˆ›å»ºå­ä»£ç†è§†å›¾ Hook
**æ–‡ä»¶**: `packages/web/src/modules/chat/composables/useSubagentView.ts`

**ç›®æ ‡**: ç®¡ç†å­ä»£ç†è§†å›¾çŠ¶æ€

**åŠŸèƒ½**:
- æ‰“å¼€/å…³é—­å­ä»£ç†è§†å›¾
- ç®¡ç†å­ä»£ç†æ¶ˆæ¯
- å­ä»£ç†æ¶ˆæ¯åˆ†ç»„
- ç‹¬ç«‹çš„æŠ˜å çŠ¶æ€ç®¡ç†

**å‚è€ƒ**: `chat.html` ç¬¬ 1950-2000 è¡Œçš„å­ä»£ç†é€»è¾‘

---

#### Task 4.2: å®ç°å­ä»£ç†è§†å›¾ UI
**æ–‡ä»¶**: `packages/web/src/modules/chat/pages/ChatPage.vue`

**ç›®æ ‡**: åœ¨ä¸»é¡µé¢ä¸­æ·»åŠ å­ä»£ç†è§†å›¾è¦†ç›–å±‚

**åŠŸèƒ½**:
- å­ä»£ç†é¡¶éƒ¨å¯¼èˆª
- å­ä»£ç†æ¶ˆæ¯åˆ—è¡¨
- è¿”å›ä¸»å¯¹è¯æŒ‰é’®
- å…¨éƒ¨æŠ˜å /å±•å¼€æŒ‰é’®

**å‚è€ƒ**: `chat.html` ç¬¬ 1150-1200 è¡Œ

---

### é˜¶æ®µ 5ï¼šæµäº‹ä»¶å¤„ç†å¢å¼º

#### Task 5.1: å®Œå–„ handleStreamEvent
**æ–‡ä»¶**: `packages/web/src/modules/chat/composables/useStreamHandler.ts`

**ç›®æ ‡**: å®Œå–„æµäº‹ä»¶å¤„ç†é€»è¾‘

**åŠŸèƒ½**:
- å¤„ç†æ‰€æœ‰äº‹ä»¶ç±»å‹ï¼ˆmessage, content, tool_use, tool_result, permission_request ç­‰ï¼‰
- å­ä»£ç†æ¶ˆæ¯å¤„ç†
- é”™è¯¯å¤„ç†
- ä¼šè¯ç»“æŸå¤„ç†

**å‚è€ƒ**: `chat.html` ç¬¬ 2200-2400 è¡Œçš„ handleStreamEvent å‡½æ•°

---

### é˜¶æ®µ 6ï¼šæ ·å¼å®Œå–„

#### Task 6.1: æ·»åŠ å…¨å±€æ ·å¼
**æ–‡ä»¶**: `packages/web/src/modules/chat/styles/chat.css`

**ç›®æ ‡**: æ·»åŠ æ‰€æœ‰ç¼ºå¤±çš„æ ·å¼

**å†…å®¹**:
- Gemini é£æ ¼è¾“å…¥å®¹å™¨æ ·å¼
- å·¥å…·å¡ç‰‡æ ·å¼
- Diff æ˜¾ç¤ºæ ·å¼
- å›¾ç‰‡æŸ¥çœ‹å™¨æ ·å¼
- æ»šåŠ¨æŒ‰é’®æ ·å¼
- Markdown æ¸²æŸ“æ ·å¼

**å‚è€ƒ**: `chat.html` ç¬¬ 15-1000 è¡Œçš„ style æ ‡ç­¾

---

#### Task 6.2: ä¼˜åŒ– ChatInput ç»„ä»¶æ ·å¼
**æ–‡ä»¶**: `packages/web/src/modules/chat/components/ChatInput.vue`

**ç›®æ ‡**: åº”ç”¨ Gemini é£æ ¼çš„è¾“å…¥å®¹å™¨

**åŠŸèƒ½**:
- å›¾ç‰‡é¢„è§ˆåŒºåŸŸ
- æŒ‰é’®è¡Œå¸ƒå±€
- å·¥ä½œç›®å½•é€‰æ‹©å™¨æ ·å¼
- Focus çŠ¶æ€æ ·å¼

**å‚è€ƒ**: `chat.html` ç¬¬ 100-400 è¡Œçš„è¾“å…¥å®¹å™¨æ ·å¼

---

### é˜¶æ®µ 7ï¼šè‡ªåŠ¨åˆ·æ–°åŠŸèƒ½

#### Task 7.1: åˆ›å»ºè‡ªåŠ¨åˆ·æ–° Hook
**æ–‡ä»¶**: `packages/web/src/modules/chat/composables/useAutoRefresh.ts`

**ç›®æ ‡**: å®ç°è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½

**ä¾èµ–**: VueUse çš„ `useIntervalFn`

**åŠŸèƒ½**:
- å¯åŠ¨/åœæ­¢è‡ªåŠ¨åˆ·æ–°
- å¯é…ç½®åˆ·æ–°é—´éš”
- åˆ·æ–°æ—¶ä¿æŒæ»šåŠ¨ä½ç½®
- é¿å…åœ¨æ“ä½œä¸­åˆ·æ–°

**å‚è€ƒ**: `chat.html` ç¬¬ 2600-2700 è¡Œçš„è‡ªåŠ¨åˆ·æ–°é€»è¾‘

---

### é˜¶æ®µ 8ï¼šç±»å‹å®šä¹‰å’Œä¼˜åŒ–

#### Task 8.1: å®Œå–„ TypeScript ç±»å‹
**æ–‡ä»¶**: `packages/web/src/types/chat.ts`

**ç›®æ ‡**: æ·»åŠ æ‰€æœ‰ç¼ºå¤±çš„ç±»å‹å®šä¹‰

**ç±»å‹**:
- ChatMessageï¼ˆå®Œæ•´ç‰ˆæœ¬ï¼‰
- ToolCallItem
- PermissionRequest
- SubagentItem
- TodoItem
- ImagePreview

---

#### Task 8.2: ä»£ç ä¼˜åŒ–å’Œé‡æ„
**æ–‡ä»¶**: æ‰€æœ‰ç›¸å…³æ–‡ä»¶

**ç›®æ ‡**: ä¼˜åŒ–ä»£ç è´¨é‡

**å†…å®¹**:
- ç§»é™¤é‡å¤ä»£ç 
- ä¼˜åŒ–æ€§èƒ½
- æ·»åŠ æ³¨é‡Š
- é”™è¯¯å¤„ç†å¢å¼º

---

## æ‰§è¡Œé¡ºåºå»ºè®®

å»ºè®®æŒ‰ç…§ä»¥ä¸‹é¡ºåºæ‰§è¡Œä»»åŠ¡ï¼š

1. **ç¬¬ä¸€æ‰¹**ï¼ˆåŸºç¡€è®¾æ–½ï¼‰ï¼šTask 1.1 â†’ Task 1.2
2. **ç¬¬äºŒæ‰¹**ï¼ˆæ¶ˆæ¯æ¸²æŸ“ï¼‰ï¼šTask 2.1 â†’ Task 2.2 â†’ Task 2.3 â†’ Task 2.4 â†’ Task 2.5
3. **ç¬¬ä¸‰æ‰¹**ï¼ˆå›¾ç‰‡åŠŸèƒ½ï¼‰ï¼šTask 3.1 â†’ Task 3.2
4. **ç¬¬å››æ‰¹**ï¼ˆå­ä»£ç†ï¼‰ï¼šTask 4.1 â†’ Task 4.2
5. **ç¬¬äº”æ‰¹**ï¼ˆæµå¤„ç†ï¼‰ï¼šTask 5.1
6. **ç¬¬å…­æ‰¹**ï¼ˆæ ·å¼ï¼‰ï¼šTask 6.1 â†’ Task 6.2
7. **ç¬¬ä¸ƒæ‰¹**ï¼ˆè‡ªåŠ¨åˆ·æ–°ï¼‰ï¼šTask 7.1
8. **ç¬¬å…«æ‰¹**ï¼ˆä¼˜åŒ–ï¼‰ï¼šTask 8.1 â†’ Task 8.2

## æ³¨æ„äº‹é¡¹

1. **æ¯æ¬¡åªæ‰§è¡Œä¸€ä¸ª Task**ï¼Œå®Œæˆåæµ‹è¯•å†ç»§ç»­
2. **ä¿æŒå‘åå…¼å®¹**ï¼Œä¸è¦ç ´åç°æœ‰åŠŸèƒ½
3. **ä½¿ç”¨ VueUse**ï¼Œé¿å…é‡å¤é€ è½®å­
4. **ç»„ä»¶é€šä¿¡ä½¿ç”¨ Emit**ï¼Œä¿æŒå•å‘æ•°æ®æµ
5. **æ·»åŠ é€‚å½“çš„æ³¨é‡Š**ï¼Œæ–¹ä¾¿åç»­ç»´æŠ¤
6. **TypeScript ç±»å‹å®Œæ•´**ï¼Œé¿å… any ç±»å‹

## æµ‹è¯•æ£€æŸ¥æ¸…å•

æ¯å®Œæˆä¸€ä¸ª Task åï¼Œæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

- [ ] åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] æ²¡æœ‰ TypeScript é”™è¯¯
- [ ] æ²¡æœ‰æ§åˆ¶å°é”™è¯¯
- [ ] æ ·å¼æ˜¾ç¤ºæ­£ç¡®
- [ ] å“åº”å¼å¸ƒå±€æ­£å¸¸
- [ ] æ€§èƒ½æ²¡æœ‰æ˜æ˜¾ä¸‹é™

---

## å¼€å§‹æ‰§è¡Œ

å‡†å¤‡å¥½åï¼Œè¯·å‘Šè¯‰æˆ‘ä»å“ªä¸ª Task å¼€å§‹ï¼Œæˆ‘ä¼šæä¾›è¯¥ Task çš„è¯¦ç»†å®ç°ä»£ç ã€‚

---

## å®Œæˆè¿›åº¦

### âœ… é˜¶æ®µ 1ï¼šåŸºç¡€è®¾æ–½å’Œå·¥å…·å‡½æ•°ï¼ˆå·²å®Œæˆï¼‰

- âœ… Task 1.1: åˆ›å»ºæ™ºèƒ½æ»šåŠ¨ Hook (`useSmartScroll.ts`)
- âœ… Task 1.2: åˆ›å»ºæ»šåŠ¨æŒ‰é’®ç»„ä»¶ (`ScrollButtons.vue`)

**å®Œæˆæ—¶é—´**: 2026-01-28

**æ–‡ä»¶æ¸…å•**:
1. `packages/web/src/modules/chat/composables/useSmartScroll.ts` - æ™ºèƒ½æ»šåŠ¨ Hook
2. `packages/web/src/modules/chat/components/ScrollButtons.vue` - æ»šåŠ¨æŒ‰é’®ç»„ä»¶

**ä½¿ç”¨ç¤ºä¾‹**:

```vue
<script setup lang="ts">
import { ref } from 'vue'
import { useSmartScroll } from '@/modules/chat/composables/useSmartScroll'
import ScrollButtons from '@/modules/chat/components/ScrollButtons.vue'

const chatContainer = ref<HTMLElement>()
const { smartScrollToBottom, isNearBottom } = useSmartScroll(chatContainer)

// æ·»åŠ æ–°æ¶ˆæ¯æ—¶æ™ºèƒ½æ»šåŠ¨
const addMessage = (message) => {
  messages.value.push(message)
  smartScrollToBottom() // åªæœ‰åœ¨æ¥è¿‘åº•éƒ¨æ—¶æ‰æ»šåŠ¨
}
</script>

<template>
  <div ref="chatContainer" class="chat-container">
    <!-- æ¶ˆæ¯åˆ—è¡¨ -->
  </div>
  
  <!-- æ»šåŠ¨æŒ‰é’® -->
  <ScrollButtons :container-ref="chatContainer" />
</template>
```

**ä¸‹ä¸€æ­¥**: å¼€å§‹é˜¶æ®µ 2 - æ¶ˆæ¯æ¸²æŸ“ç»„ä»¶å®Œå–„
